{"ast":null,"code":"import _regeneratorRuntime from\"/Users/amansingh/Desktop/CodeWithMe/codewithme/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/amansingh/Desktop/CodeWithMe/codewithme/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/amansingh/Desktop/CodeWithMe/codewithme/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useRef}from\"react\";import{useState}from\"react\";import CodeMirror from\"@uiw/react-codemirror\";import{autocompletion,closeBrackets,closeBracketsKeymap,completionKeymap}from'@codemirror/autocomplete';import{vscodeDark}from\"@uiw/codemirror-theme-vscode\";import{javascript}from'@codemirror/lang-javascript';import{EditorState}from'@codemirror/state';import axios from\"axios\";import ACTIONS from\"../action\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Editor=function Editor(_ref){var socketRef=_ref.socketRef,roomID=_ref.roomID;var editorRef=useRef(null);var _useState=useState(\"console.log('Start Writing!');\"),_useState2=_slicedToArray(_useState,2),code=_useState2[0],setCode=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),output=_useState4[0],setOutput=_useState4[1];var runCode=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;editorRef.current=setOutput(\"Running...\");_context.next=4;return axios.post(\"https://runkit.io/api/run/1.0.0\",{code:code},{headers:{\"Content-Type\":\"application/json\"}});case 4:response=_context.sent;setOutput(response.data);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);setOutput(\"Error: \"+_context.t0.message);case 11:editorRef.current.on('change',function(instance,changes){console.log('changes',changes);var origin=changes.origin;var code=instance.getValue();if(origin!=='setValue'){socketRef.current.emit(ACTIONS.CODE_CHANGE,{roomID:roomID,code:code});}console.log();});case 12:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function runCode(){return _ref2.apply(this,arguments);};}();useEffect(function(){if(socketRef.current)socketRef.current.on(ACTIONS.CODE_CHANGE,function(_ref3){var code=_ref3.code;if(code!==null){editorRef.current.setValue();}});},[socketRef.current]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CodeMirror,{value:code,height:\"650px\",theme:vscodeDark,options:{mode:{name:javascript(),json:true},theme:'material',lineNumbers:true,autocompletion:true,closeBrackets:true},onChange:function onChange(editor,data,value){setCode(value);}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn runbtn\",onClick:runCode,children:\"Run\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"outputtxt\",children:\"Output:\"}),/*#__PURE__*/_jsx(\"pre\",{children:output})]});};export default Editor;","map":{"version":3,"names":["React","useEffect","useRef","useState","CodeMirror","autocompletion","closeBrackets","closeBracketsKeymap","completionKeymap","vscodeDark","javascript","EditorState","axios","ACTIONS","jsx","_jsx","jsxs","_jsxs","Editor","_ref","socketRef","roomID","editorRef","_useState","_useState2","_slicedToArray","code","setCode","_useState3","_useState4","output","setOutput","runCode","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","current","post","headers","sent","data","t0","message","on","instance","changes","console","log","origin","getValue","emit","CODE_CHANGE","stop","apply","arguments","_ref3","setValue","children","value","height","theme","options","mode","name","json","lineNumbers","onChange","editor","className","onClick"],"sources":["/Users/amansingh/Desktop/CodeWithMe/codewithme/src/components/Editor.js"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport { useState } from \"react\";\nimport CodeMirror from \"@uiw/react-codemirror\";\nimport { autocompletion, closeBrackets, closeBracketsKeymap, completionKeymap } from '@codemirror/autocomplete'\nimport { vscodeDark } from \"@uiw/codemirror-theme-vscode\";\nimport { javascript } from '@codemirror/lang-javascript';\nimport { EditorState } from '@codemirror/state';\nimport axios from \"axios\";\nimport ACTIONS from \"../action\";\n\n\nconst Editor = ({ socketRef, roomID }) => {\n    const editorRef = useRef(null);\n    const [code, setCode] = useState(\"console.log('Start Writing!');\");\n    const [output, setOutput] = useState(\"\");\n\n    const runCode = async () => {\n        try {\n            editorRef.current = setOutput(\"Running...\");\n\n            const response = await axios.post(\n                \"https://runkit.io/api/run/1.0.0\",\n                { code },\n                {\n                    headers: {\n                        \"Content-Type\": \"application/json\",\n                    },\n                }\n            );\n\n            setOutput(response.data);\n        } catch (error) {\n            setOutput(\"Error: \" + error.message);\n        }\n        editorRef.current.on('change', (instance, changes) => {\n            console.log('changes', changes)\n            const { origin } = changes;\n            const code = instance.getValue();\n            if (origin !== 'setValue') {\n                socketRef.current.emit(ACTIONS.CODE_CHANGE, {\n                    roomID,\n                    code,\n                });\n            }\n            console.log();\n        })\n\n    };\n    useEffect(() => {\n        if (socketRef.current)\n            socketRef.current.on(ACTIONS.CODE_CHANGE, ({ code }) => {\n                if (code !== null) {\n                    editorRef.current.setValue();\n                }\n            })\n    }, [socketRef.current])\n\n    return (\n        <div>\n            <CodeMirror\n                value={code}\n                height=\"650px\"\n                theme={vscodeDark}\n                options={{\n                    mode: { name: javascript(), json: true },\n                    theme: 'material',\n                    lineNumbers: true,\n                    autocompletion: true,\n                    closeBrackets: true,\n\n                }}\n                onChange={(editor, data, value) => {\n                    setCode(value);\n                }}\n            />\n            <button className=\"btn runbtn\" onClick={runCode}>Run</button>\n            <h2 className=\"outputtxt\">Output:</h2>\n            <pre>{output}</pre>\n        </div>\n    );\n};\n\nexport default Editor;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}