{"ast":null,"code":"import _regeneratorRuntime from\"/Users/amansingh/Desktop/CodeWithMe/codewithme/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/amansingh/Desktop/CodeWithMe/codewithme/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/amansingh/Desktop/CodeWithMe/codewithme/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useRef,useEffect}from'react';import Client from'../components/Client';import Editor from'../components/Editor';import{initSocket}from'../socket';import ACTIONS from'../action';import{useLocation,useNavigate,Navigate,useParams}from'react-router-dom';import{toast}from'react-hot-toast';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Compiler=function Compiler(){var socket='http://localhost:5000';var socketRef=useRef(null);var location=useLocation();var reactNavigator=useNavigate();var _useParams=useParams(),roomId=_useParams.roomId;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),clients=_useState2[0],setClients=_useState2[1];useEffect(function(){var init=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _location$state;var handleErrors;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:handleErrors=function _handleErrors(e){console.log('socket error',e);};socketRef.current=initSocket();socketRef.current.on('connect_error',function(err){return handleErrors(err);});socketRef.current.on('connect_failed',function(err){return handleErrors(err);});socketRef.current.emit(ACTIONS.JOIN,{roomId:roomId,username:(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.username});socketRef.current.on(ACTIONS.JOINED,function(_ref2){var _location$state2;var clients=_ref2.clients,username=_ref2.username,socketId=_ref2.socketId;if(username!==((_location$state2=location.state)===null||_location$state2===void 0?void 0:_location$state2.username)){toast.success(\"\".concat(username,\" joined the room\"));}setClients(clients);});socketRef.current.on(ACTIONS.DISCONNECTED,function(_ref3){var socketId=_ref3.socketId;toast.success(\"Someone left\");setClients(function(prev){return prev.filter(function(client){return client.socketId!==socketId;});});});case 7:case\"end\":return _context.stop();}},_callee);}));return function init(){return _ref.apply(this,arguments);};}();init();return function(){socketRef.current.off(ACTIONS.JOINED);socketRef.current.off(ACTIONS.DISCONNECTED);};},[]);function leaveroom(){reactNavigator('/');}function copyroomid(){return _copyroomid.apply(this,arguments);}function _copyroomid(){_copyroomid=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return navigator.clipboard.writeText(roomId);case 3:toast.success('Room ID copied');_context2.next=9;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);toast.error('Not Copied');case 9:case\"end\":return _context2.stop();}},_callee2,null,[[0,6]]);}));return _copyroomid.apply(this,arguments);}if(!location.state){return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"mainblock\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"innersidebar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/logo1.png\",alt:\"logo\",className:\"logoimg\"})}),/*#__PURE__*/_jsx(\"h3\",{children:\"Connected\"}),/*#__PURE__*/_jsx(\"div\",{className:\"clientsList\",children:clients.map(function(client){return/*#__PURE__*/_jsx(Client,{username:client.username},client.socketId);})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn copybtn\",onClick:copyroomid,children:\"Copy Room ID\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn leavebtn\",onClick:leaveroom,children:\"Leave\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"editorblock\",children:/*#__PURE__*/_jsx(Editor,{socketRef:socketRef,roomId:roomId})})]});};export default Compiler;","map":{"version":3,"names":["React","useState","useRef","useEffect","Client","Editor","initSocket","ACTIONS","useLocation","useNavigate","Navigate","useParams","toast","jsx","_jsx","jsxs","_jsxs","Compiler","socket","socketRef","location","reactNavigator","_useParams","roomId","_useState","_useState2","_slicedToArray","clients","setClients","init","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_location$state","handleErrors","wrap","_callee$","_context","prev","next","_handleErrors","e","console","log","current","on","err","emit","JOIN","username","state","JOINED","_ref2","_location$state2","socketId","success","concat","DISCONNECTED","_ref3","filter","client","stop","apply","arguments","off","leaveroom","copyroomid","_copyroomid","_callee2","_callee2$","_context2","navigator","clipboard","writeText","t0","error","to","className","children","src","alt","map","onClick"],"sources":["/Users/amansingh/Desktop/CodeWithMe/codewithme/src/pages/compiler.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react'\nimport Client from '../components/Client';\nimport Editor from '../components/Editor';\nimport { initSocket } from '../socket';\nimport ACTIONS from '../action';\nimport { useLocation, useNavigate, Navigate, useParams } from 'react-router-dom'\nimport { toast } from 'react-hot-toast';\nconst Compiler = () => {\n    const socket = ('http://localhost:5000');\n    const socketRef = useRef(null);\n    const location = useLocation();\n    const reactNavigator = useNavigate();\n    const { roomId } = useParams();\n    const [clients, setClients] = useState([\n\n    ]);\n\n    useEffect(() => {\n        const init = async () => {\n            socketRef.current = initSocket();\n            socketRef.current.on('connect_error', (err) => handleErrors(err));\n            socketRef.current.on('connect_failed', (err) => handleErrors(err));\n\n            function handleErrors(e) {\n                console.log('socket error', e);\n            }\n            socketRef.current.emit(ACTIONS.JOIN, {\n                roomId,\n                username: location.state?.username,\n            });\n\n            socketRef.current.on(ACTIONS.JOINED, ({ clients, username, socketId }) => {\n                if (username !== location.state?.username) {\n                    toast.success(`${username} joined the room`)\n                }\n                setClients(clients);\n            })\n            socketRef.current.on(ACTIONS.DISCONNECTED, ({ socketId }) => {\n                toast.success(`Someone left`)\n                setClients((prev) => {\n                    return prev.filter(\n                        (client) => client.socketId !== socketId\n                    );\n                })\n            })\n        };\n        init();\n        return () => {\n            socketRef.current.off(ACTIONS.JOINED);\n            socketRef.current.off(ACTIONS.DISCONNECTED);\n\n        }\n    }, []);\n\n    function leaveroom() {\n        reactNavigator('/')\n    }\n\n    async function copyroomid() {\n        try {\n            await navigator.clipboard.writeText(roomId);\n            toast.success('Room ID copied')\n        }\n        catch (err) {\n            toast.error('Not Copied')\n        }\n    }\n\n    if (!location.state) {\n        return < Navigate to=\"/\" />;\n    }\n\n    return <div className='mainblock'>\n        <div className='sidebar'>\n            <div className='innersidebar'>\n                <div className='logo'>\n                    <img src='/logo1.png' alt='logo' className='logoimg' />\n                </div>\n                <h3>Connected</h3>\n                <div className='clientsList'>\n                    {\n                        clients.map((client) => (\n                            <Client key={client.socketId} username={client.username} />\n                        ))\n                    }\n                </div>\n            </div>\n            <button className='btn copybtn' onClick={copyroomid}>Copy Room ID</button>\n            <button className='btn leavebtn' onClick={leaveroom}>Leave</button>\n        </div>\n        <div className='editorblock'>\n            <Editor socketRef={socketRef} roomId={roomId} />\n        </div>\n    </div>\n};\n\nexport default Compiler;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}